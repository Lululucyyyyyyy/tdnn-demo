const DEBUG = true; 
/** ===================================================== 
 *            PARAMETERS  
* ===================================================== 
*/

var tdnn1Weight = [[2.084385156631469727e-01,-1.834468692541122437e-01,-5.573158711194992065e-02,5.504557490348815918e-01,-7.437799125909805298e-02,1.805398799479007721e-02,3.745999932289123535e-01,-1.530749052762985229e-01,5.000188946723937988e-01,1.780875027179718018e-01,-7.861075550317764282e-02,3.326122649013996124e-03,-1.258114427328109741e-01,-5.991563573479652405e-02,3.643904924392700195e-01,4.226166009902954102e-02,-1.041962020099163055e-02,-8.645051717758178711e-02,-8.944658637046813965e-01,-4.440966844558715820e-01,-5.682656168937683105e-01,-1.102665662765502930e-01,1.191567629575729370e-01,6.800347566604614258e-02,1.143429279327392578e-01,5.497493781149387360e-03,2.393731623888015747e-01,4.514247775077819824e-01,-8.211127482354640961e-03,-1.178914960473775864e-02,-9.627041220664978027e-01,5.481417756527662277e-04,5.509923100471496582e-01,-6.417393684387207031e-01,5.001107603311538696e-02,-8.933746814727783203e-02,-1.876820623874664307e-01,2.341277152299880981e-01,1.205611974000930786e-01,-4.468694031238555908e-01,-2.310455031692981720e-02,-1.879663318395614624e-01,-9.346023201942443848e-02,2.139372378587722778e-01,3.571195304393768311e-01,-1.298890560865402222e-01,-1.605254411697387695e-01,-6.205919384956359863e-02], 
[2.175602167844772339e-01,-7.732711434364318848e-01,5.589372012764215469e-03,1.852933615446090698e-01,-5.006489157676696777e-01,1.209039092063903809e-01,-7.630204558372497559e-01,-6.067180633544921875e-01,9.772533774375915527e-01,-3.167679309844970703e-01,-4.498623013496398926e-01,-4.121040701866149902e-01,-1.471657902002334595e-01,1.410393714904785156e-01,7.554017305374145508e-01,-1.234569549560546875e+00,-2.564188838005065918e-01,4.968096315860748291e-01,6.051511168479919434e-01,6.362916231155395508e-01,2.590588033199310303e-01,3.990208804607391357e-01,3.104212507605552673e-02,-5.280281305313110352e-01,1.284664034843444824e+00,1.446725487709045410e+00,-4.087098538875579834e-01,3.324871957302093506e-01,-1.185221523046493530e-01,-7.185317277908325195e-01,4.510382562875747681e-02,-5.531229376792907715e-01,-3.156721591949462891e-01,-2.891580015420913696e-02,4.562203288078308105e-01,2.147555723786354065e-02,-5.316757410764694214e-02,-5.563527345657348633e-01,2.352161854505538940e-01,-1.798521131277084351e-01,-2.075917869806289673e-01,5.071557313203811646e-02,5.547852516174316406e-01,-4.711021780967712402e-01,6.055778264999389648e-01,6.000594496726989746e-01,1.805627942085266113e-01,9.961536526679992676e-01], 
[-5.586110427975654602e-02,-3.937376439571380615e-01,2.328036874532699585e-01,-1.771821081638336182e-01,-8.183849453926086426e-01,-6.773213744163513184e-01,-2.349618077278137207e-01,3.991748094558715820e-01,1.067803978919982910e+00,-7.777966558933258057e-02,-6.631008982658386230e-01,-5.217178463935852051e-01,8.468575477600097656e-01,1.836515069007873535e-01,2.106678485870361328e-01,6.351594328880310059e-01,1.685079932212829590e-01,-3.976494669914245605e-01,5.192283391952514648e-01,1.798719465732574463e-01,2.642382085323333740e-01,1.001336932182312012e+00,4.994027614593505859e-01,-1.046624630689620972e-01,-4.920161366462707520e-01,-5.899353623390197754e-01,-3.205798566341400146e-01,-6.804372668266296387e-01,-9.428434967994689941e-01,-7.178350090980529785e-01,9.156752824783325195e-01,5.096103549003601074e-01,5.150404572486877441e-01,6.988225877285003662e-02,1.103775650262832642e-01,-1.413840204477310181e-01,-9.075464680790901184e-03,-4.745134711265563965e-01,2.866348624229431152e-02,2.812213897705078125e-01,2.480602860450744629e-01,1.819012016057968140e-01,5.659700632095336914e-01,3.162572532892227173e-02,-1.269186735153198242e-01,-8.223505318164825439e-02,1.724695861339569092e-01,2.769932150840759277e-01], 
[9.030858278274536133e-01,3.141407072544097900e-01,-1.109864786267280579e-01,-1.374184191226959229e-01,-1.278272420167922974e-01,-7.837773859500885010e-02,-1.180498003959655762e+00,7.996416091918945312e-01,9.347064495086669922e-01,-2.725819349288940430e-01,1.145917624235153198e-01,-7.344389557838439941e-01,-3.690577447414398193e-01,3.995489180088043213e-01,9.053105488419532776e-03,-6.205559372901916504e-01,-4.660165905952453613e-01,-5.014552548527717590e-02,2.661231756210327148e-01,1.078181192278862000e-01,-5.042909979820251465e-01,2.598157525062561035e-01,1.209493167698383331e-02,-9.061728715896606445e-01,-3.697657883167266846e-01,7.179489731788635254e-02,-1.105221584439277649e-01,-1.403962820768356323e-01,4.961329996585845947e-01,6.921824216842651367e-01,1.005624175071716309e+00,7.730242013931274414e-01,5.074923634529113770e-01,-2.364869862794876099e-01,1.361657083034515381e-01,-2.986245155334472656e-01,5.646544042974710464e-03,3.545169830322265625e-01,5.676235556602478027e-01,4.478287100791931152e-01,1.163696572184562683e-01,-2.394361346960067749e-01,-2.782856225967407227e-01,2.661190629005432129e-01,-1.305126845836639404e-01,-4.019278883934020996e-01,-1.403295099735260010e-01,-3.511286079883575439e-01], 
[5.671738982200622559e-01,7.098402082920074463e-02,2.449969500303268433e-01,5.721740722656250000e-01,2.155822813510894775e-01,-5.940860509872436523e-01,3.736505806446075439e-01,-4.535532742738723755e-02,-3.240841329097747803e-01,8.932201564311981201e-02,1.884624809026718140e-01,3.944080173969268799e-01,2.429376840591430664e-01,6.380342245101928711e-01,5.186756253242492676e-01,-2.444771118462085724e-02,-3.328969478607177734e-01,-3.476787805557250977e-01,-2.029847949743270874e-01,6.002238392829895020e-02,3.715113103389739990e-01,4.609414637088775635e-01,5.020672678947448730e-01,6.116244196891784668e-01,-1.311902552843093872e-01,-3.379306793212890625e-01,-2.025665491819381714e-01,-7.232699394226074219e-01,-5.577601194381713867e-01,2.203986644744873047e-01,-1.165107488632202148e+00,4.395129904150962830e-02,1.137900710105895996e+00,-7.511973381042480469e-01,-1.519971936941146851e-01,3.795893490314483643e-01,-6.400604248046875000e-01,-2.701354920864105225e-01,3.848720788955688477e-01,-6.336699128150939941e-01,-5.199875831604003906e-01,-8.725333213806152344e-02,-4.291299879550933838e-01,1.429324746131896973e-01,5.130957961082458496e-01,-9.646395221352577209e-03,-9.962474554777145386e-02,-2.528245449066162109e-01], 
[-5.741712450981140137e-01,-1.026277095079421997e-01,-9.936685860157012939e-02,4.750519692897796631e-01,5.044629424810409546e-02,2.591040730476379395e-01,9.953557848930358887e-01,1.601088643074035645e-01,1.479503363370895386e-01,-3.611174523830413818e-01,5.672133341431617737e-02,-3.531884253025054932e-01,1.476783156394958496e-01,2.153661549091339111e-01,7.024639248847961426e-01,-4.069050252437591553e-01,-1.412575691938400269e-02,2.941829264163970947e-01,-6.703760027885437012e-01,-5.026355981826782227e-01,-1.315711066126823425e-02,-1.053514599800109863e+00,-5.302177667617797852e-01,2.561622560024261475e-01,-4.548640251159667969e-01,-9.738241136074066162e-02,8.302439451217651367e-01,-1.672721356153488159e-01,3.491595685482025146e-01,6.720376759767532349e-02,-5.272795557975769043e-01,4.265388008207082748e-03,-1.361669152975082397e-01,-1.387857645750045776e-01,2.416055835783481598e-02,4.383504688739776611e-01,-5.703208222985267639e-02,1.672396808862686157e-01,1.755813360214233398e-01,7.626045495271682739e-02,2.844345867633819580e-01,-1.174537986516952515e-01,1.149996891617774963e-01,3.854541778564453125e-01,1.145723462104797363e-01,-5.266550183296203613e-01,3.507170826196670532e-02,1.236043125391006470e-01], 
[2.105349153280258179e-01,1.266898959875106812e-01,6.897593140602111816e-01,1.201520934700965881e-01,-3.573441505432128906e-01,-3.968049287796020508e-01,2.790260910987854004e-01,-7.938060164451599121e-01,-1.383545845746994019e-01,-4.459846317768096924e-01,-9.027832746505737305e-01,2.497812658548355103e-01,7.428763508796691895e-01,-7.792092114686965942e-02,6.961395144462585449e-01,7.312277555465698242e-01,2.483575195074081421e-01,2.637406885623931885e-01,1.202960149385035038e-03,1.848649531602859497e-01,7.289939522743225098e-01,-4.102995395660400391e-01,3.853668272495269775e-01,5.191983580589294434e-01,2.586307227611541748e-01,-6.446036100387573242e-01,-7.534280419349670410e-01,6.060750484466552734e-01,2.717805504798889160e-01,3.333073481917381287e-02,-1.258003950119018555e+00,-5.057737231254577637e-01,1.799303665757179260e-02,-1.141329258680343628e-01,4.092384874820709229e-02,2.642830312252044678e-01,-1.996556296944618225e-02,3.633304834365844727e-01,9.291635826230049133e-03,-7.926587462425231934e-01,-2.768208384513854980e-01,3.750878572463989258e-02,-4.735608100891113281e-01,1.302172839641571045e-01,5.956879258155822754e-01,-2.882459461688995361e-01,-1.976307183504104614e-01,1.917350590229034424e-01], 
[-6.952340006828308105e-01,8.770852088928222656e-01,-4.505190253257751465e-02,-7.689273357391357422e-01,-3.078736066818237305e-01,2.321438193321228027e-01,9.293437600135803223e-01,2.936842143535614014e-01,2.671884894371032715e-01,-3.118597436696290970e-03,1.403970718383789062e-01,3.312129676342010498e-01,-1.326827108860015869e-01,2.888415753841400146e-02,-3.126020729541778564e-01,1.914633661508560181e-01,-5.390661358833312988e-01,-8.521873354911804199e-01,1.889228969812393188e-01,-1.358502060174942017e-01,-1.981374919414520264e-01,-1.341852396726608276e-01,6.123378276824951172e-01,1.115200281143188477e+00,-1.248068928718566895e+00,-2.395630776882171631e-01,6.917276978492736816e-01,-1.063564658164978027e+00,7.760183811187744141e-01,1.243135690689086914e+00,-7.178968191146850586e-01,1.089844703674316406e-01,-1.152808591723442078e-01,2.080270498991012573e-01,1.306918114423751831e-01,-2.810499966144561768e-01,1.175597757101058960e-01,1.603117287158966064e-01,-4.239454865455627441e-01,2.316793799400329590e-01,5.010679364204406738e-02,-6.276437640190124512e-01,6.525329351425170898e-01,4.673563539981842041e-01,2.795352339744567871e-01,5.289167910814285278e-02,2.614771723747253418e-01,3.600752949714660645e-01] ];

var tdnn1Bias = [-1.186564087867736816e+00, 
-1.289186954498291016e+00, 
-4.657509922981262207e-01, 
1.455784082412719727e+00, 
-1.970072865486145020e+00, 
8.273705095052719116e-02, 
-7.871655821800231934e-01, 
-7.737065106630325317e-02];

var tdnn2Weight = [[9.426070451736450195e-01,-9.960948675870895386e-02,5.115338787436485291e-02,-2.351450681686401367e+00,-3.948810398578643799e-01,1.329336613416671753e-01,9.254231452941894531e-01,1.396586894989013672e-01,-1.026809141039848328e-01,-1.135194897651672363e+00,2.383351624011993408e-01,3.417197763919830322e-01,5.882883071899414062e-01,1.953051388263702393e-01,-3.822517991065979004e-01,7.587750256061553955e-02,2.649142444133758545e-01,4.020857512950897217e-01,1.144687294960021973e+00,1.107873511500656605e-03,-7.756950259208679199e-01,1.211317658424377441e+00,4.441630244255065918e-01,1.879991739988327026e-01], 
[-1.729583740234375000e+00,-3.851801156997680664e-01,-1.351159065961837769e-01,-1.627917051315307617e+00,4.888115525245666504e-01,-4.644836187362670898e-01,-4.376147985458374023e-01,-2.111164331436157227e+00,9.503533244132995605e-01,2.843920141458511353e-02,-1.815567255020141602e+00,-1.372747182846069336e+00,-1.666839122772216797e+00,-1.628994226455688477e+00,-1.162493109703063965e+00,1.166107177734375000e+00,1.205242753028869629e+00,6.483306884765625000e-01,-1.023313522338867188e+00,1.840279698371887207e+00,7.637413144111633301e-01,2.072170019149780273e+00,2.832118570804595947e-01,1.122402667999267578e+00], 
[-6.831287145614624023e-01,-1.736567616462707520e-01,-6.874323487281799316e-01,3.527288913726806641e+00,8.823089003562927246e-01,-2.486466802656650543e-02,1.933220028877258301e+00,-7.129263281822204590e-01,-1.296492218971252441e+00,2.711282730102539062e+00,3.423343002796173096e-01,-1.545034646987915039e-01,-5.318973660469055176e-01,6.997467279434204102e-01,5.477970242500305176e-01,-1.854849576950073242e+00,5.881243944168090820e-01,-1.126029253005981445e+00,-2.896948575973510742e+00,-4.450493156909942627e-01,8.849483728408813477e-01,-2.520957708358764648e+00,8.951302170753479004e-01,2.936536967754364014e-01] ];

var tdnn2Bias = [-5.460759401321411133e-01, 
8.398687839508056641e-01, 
3.712629973888397217e-01];

var linearWeight = [[1.807703614234924316e+00,1.965206265449523926e+00,8.894171714782714844e-01,5.464522838592529297e-01,6.760225892066955566e-01,-6.244010291993618011e-03,1.064039468765258789e-01,3.923033177852630615e-01,6.749322414398193359e-01,-2.483788877725601196e-01,-9.074859023094177246e-01,-3.266861140727996826e-01,-2.508744001388549805e-01,-3.343390524387359619e-01,-2.804451286792755127e-01,-2.175572961568832397e-01,2.473219931125640869e-01,1.241078451275825500e-01,-5.627947807312011719e+00,-4.093192100524902344e+00,-2.269150167703628540e-01,1.941587924957275391e-01,-1.218338757753372192e-01,7.749370932579040527e-01,8.224323987960815430e-01,1.530639827251434326e-01,-9.966780245304107666e-02], 
[2.572504580020904541e-01,-1.519493699073791504e+00,-1.245479702949523926e+00,-1.088494062423706055e+00,-6.477654576301574707e-01,-1.835327744483947754e-01,7.202727794647216797e-01,-9.340067207813262939e-02,1.176398694515228271e-01,3.604768276214599609e+00,3.286731481552124023e+00,1.643366932868957520e+00,8.440181016921997070e-01,8.854262232780456543e-01,7.048279047012329102e-01,-1.549057662487030029e-01,1.358117461204528809e-01,5.750796794891357422e-01,1.226845383644104004e+00,2.249124526977539062e+00,-9.664589762687683105e-01,-1.705877780914306641e+00,-6.752036809921264648e-01,-5.797365903854370117e-01,-9.703070521354675293e-01,-2.921009361743927002e-01,-5.952850580215454102e-01], 
[-2.201942205429077148e+00,-8.045266866683959961e-01,2.960292100906372070e-01,4.317111074924468994e-01,-1.515622586011886597e-01,-2.483055554330348969e-02,-9.082201719284057617e-01,-4.813192188739776611e-01,-5.435063838958740234e-01,-3.283082962036132812e+00,-2.387123107910156250e+00,-9.859501123428344727e-01,-5.727315545082092285e-01,-8.001838922500610352e-01,-3.927576243877410889e-01,2.219703495502471924e-01,-3.489352390170097351e-02,-1.015247702598571777e+00,4.443435668945312500e+00,2.066252946853637695e+00,1.259069681167602539e+00,1.546111345291137695e+00,8.645327687263488770e-01,-3.969681560993194580e-01,-1.454447209835052490e-01,3.850679099559783936e-01,4.497138261795043945e-01] ];

var linearBias = [6.619359254837036133e-01, 
-6.569730043411254883e-01, 
2.373500168323516846e-01];


var mean = tf.tensor([[-9.921779632568359375e+01,-9.504090118408203125e+01,-8.973951721191406250e+01,-8.813558197021484375e+01,-8.830461120605468750e+01,-8.856550598144531250e+01,-8.888496398925781250e+01,-8.919696044921875000e+01,-8.920588684082031250e+01,-8.911086273193359375e+01,-8.906544494628906250e+01,-8.904513549804687500e+01,-8.914320373535156250e+01,-8.955490112304687500e+01,-8.991511535644531250e+01], 
[-9.075273895263671875e+01,-8.522019958496093750e+01,-7.967333221435546875e+01,-7.790902709960937500e+01,-7.802523040771484375e+01,-7.837438964843750000e+01,-7.870838165283203125e+01,-7.894293975830078125e+01,-7.885326385498046875e+01,-7.910064697265625000e+01,-7.926168060302734375e+01,-7.943693542480468750e+01,-7.991612243652343750e+01,-8.026557159423828125e+01,-8.086238098144531250e+01], 
[-8.412979888916015625e+01,-6.861726379394531250e+01,-6.160314941406250000e+01,-6.338418579101562500e+01,-6.599925994873046875e+01,-6.798213958740234375e+01,-6.950867462158203125e+01,-7.063717651367187500e+01,-7.091154479980468750e+01,-7.082058715820312500e+01,-7.097940063476562500e+01,-7.131390380859375000e+01,-7.197600555419921875e+01,-7.263725280761718750e+01,-7.344942474365234375e+01], 
[-8.202547454833984375e+01,-6.726231384277343750e+01,-5.978254318237304688e+01,-6.155418777465820312e+01,-6.529390716552734375e+01,-6.734429931640625000e+01,-6.786521148681640625e+01,-6.780727386474609375e+01,-6.755405426025390625e+01,-6.708668518066406250e+01,-6.696781158447265625e+01,-6.702466583251953125e+01,-6.764759063720703125e+01,-6.841866302490234375e+01,-6.933186340332031250e+01], 
[-8.036808013916015625e+01,-6.402169036865234375e+01,-5.607803344726562500e+01,-5.880026626586914062e+01,-6.428195953369140625e+01,-6.832103729248046875e+01,-7.112860870361328125e+01,-7.360625457763671875e+01,-7.552908325195312500e+01,-7.663933563232421875e+01,-7.728362274169921875e+01,-7.783981323242187500e+01,-7.859137725830078125e+01,-7.903635406494140625e+01,-7.949150085449218750e+01], 
[-8.586244201660156250e+01,-7.212140655517578125e+01,-6.461985778808593750e+01,-6.482037353515625000e+01,-6.638748168945312500e+01,-6.699520111083984375e+01,-6.709673309326171875e+01,-6.718971252441406250e+01,-6.749736022949218750e+01,-6.796173095703125000e+01,-6.862870025634765625e+01,-6.960826873779296875e+01,-7.095992279052734375e+01,-7.243920135498046875e+01,-7.385276031494140625e+01], 
[-9.252242279052734375e+01,-8.193151092529296875e+01,-7.508731842041015625e+01,-7.333493804931640625e+01,-7.292675781250000000e+01,-7.279851531982421875e+01,-7.268202209472656250e+01,-7.286110687255859375e+01,-7.331530761718750000e+01,-7.410264587402343750e+01,-7.514087677001953125e+01,-7.653645324707031250e+01,-7.808036041259765625e+01,-7.972187042236328125e+01,-8.124539184570312500e+01], 
[-9.631140899658203125e+01,-8.653366851806640625e+01,-8.058126831054687500e+01,-7.914875793457031250e+01,-7.901523590087890625e+01,-7.861658477783203125e+01,-7.815832519531250000e+01,-7.778381347656250000e+01,-7.776296234130859375e+01,-7.808188629150390625e+01,-7.881516265869140625e+01,-7.998609924316406250e+01,-8.121701812744140625e+01,-8.286320495605468750e+01,-8.452704620361328125e+01], 
[-9.898571014404296875e+01,-8.902489471435546875e+01,-8.325489807128906250e+01,-8.206025695800781250e+01,-8.217173767089843750e+01,-8.206777191162109375e+01,-8.179553985595703125e+01,-8.158620452880859375e+01,-8.159114074707031250e+01,-8.194551849365234375e+01,-8.271591186523437500e+01,-8.379262542724609375e+01,-8.527125549316406250e+01,-8.693087768554687500e+01,-8.870130157470703125e+01], 
[-9.731649017333984375e+01,-8.746131896972656250e+01,-8.236929321289062500e+01,-8.149582672119140625e+01,-8.243120574951171875e+01,-8.343588256835937500e+01,-8.419934844970703125e+01,-8.490605926513671875e+01,-8.560294342041015625e+01,-8.626959228515625000e+01,-8.705041503906250000e+01,-8.810766601562500000e+01,-8.930487823486328125e+01,-9.074024963378906250e+01,-9.222308349609375000e+01], 
[-9.826397705078125000e+01,-8.894941711425781250e+01,-8.401177215576171875e+01,-8.338196563720703125e+01,-8.433952331542968750e+01,-8.555004119873046875e+01,-8.656681823730468750e+01,-8.752682495117187500e+01,-8.855826568603515625e+01,-8.962059020996093750e+01,-9.101210021972656250e+01,-9.245796966552734375e+01,-9.387190246582031250e+01,-9.542288208007812500e+01,-9.662644195556640625e+01], 
[-9.758805847167968750e+01,-8.834228515625000000e+01,-8.355352020263671875e+01,-8.284117889404296875e+01,-8.438226318359375000e+01,-8.553290557861328125e+01,-8.683411407470703125e+01,-8.788558197021484375e+01,-8.858779907226562500e+01,-8.931116485595703125e+01,-9.036820220947265625e+01,-9.214134216308593750e+01,-9.370903015136718750e+01,-9.552278137207031250e+01,-9.680800628662109375e+01], 
[-9.765615844726562500e+01,-8.873693847656250000e+01,-8.364011383056640625e+01,-8.329731750488281250e+01,-8.454096221923828125e+01,-8.573168182373046875e+01,-8.697409820556640625e+01,-8.778545379638671875e+01,-8.855834960937500000e+01,-8.963303375244140625e+01,-9.094887542724609375e+01,-9.237593841552734375e+01,-9.429281616210937500e+01,-9.624318695068359375e+01,-9.695343017578125000e+01], 
[-9.815158843994140625e+01,-8.933801269531250000e+01,-8.410716247558593750e+01,-8.340456390380859375e+01,-8.445557403564453125e+01,-8.543481445312500000e+01,-8.658629608154296875e+01,-8.749824523925781250e+01,-8.807286834716796875e+01,-8.953565979003906250e+01,-9.124960327148437500e+01,-9.246335601806640625e+01,-9.420965576171875000e+01,-9.559263610839843750e+01,-9.662376403808593750e+01], 
[-9.828052520751953125e+01,-8.904106903076171875e+01,-8.426504516601562500e+01,-8.347032165527343750e+01,-8.486686706542968750e+01,-8.609704589843750000e+01,-8.698790740966796875e+01,-8.745210266113281250e+01,-8.841204833984375000e+01,-8.972669219970703125e+01,-9.148091888427734375e+01,-9.288640594482421875e+01,-9.457704925537109375e+01,-9.601776885986328125e+01,-9.699620056152343750e+01], 
[-9.812028503417968750e+01,-8.886190032958984375e+01,-8.393420410156250000e+01,-8.361576843261718750e+01,-8.467249298095703125e+01,-8.585780334472656250e+01,-8.655090332031250000e+01,-8.710252380371093750e+01,-8.824201965332031250e+01,-8.932933044433593750e+01,-9.117467498779296875e+01,-9.287101745605468750e+01,-9.428778839111328125e+01,-9.571419525146484375e+01,-9.688137054443359375e+01] ]);

var std = tf.tensor([[7.291962146759033203e+00,6.192818641662597656e+00,5.265135765075683594e+00,4.817301750183105469e+00,4.849774837493896484e+00,4.931700706481933594e+00,5.114341735839843750e+00,4.976315975189208984e+00,5.107829093933105469e+00,5.051663875579833984e+00,5.053170204162597656e+00,4.976277828216552734e+00,5.141225814819335938e+00,5.251046657562255859e+00,5.735521316528320312e+00], 
[6.227247238159179688e+00,6.359817028045654297e+00,5.596925258636474609e+00,4.969506263732910156e+00,4.597284793853759766e+00,4.621735572814941406e+00,4.563295841217041016e+00,4.651117801666259766e+00,4.738206386566162109e+00,4.712651729583740234e+00,4.750311374664306641e+00,4.821494102478027344e+00,4.898801326751708984e+00,5.107782363891601562e+00,5.429637908935546875e+00], 
[1.150111865997314453e+01,6.955057621002197266e+00,3.791831493377685547e+00,3.825676441192626953e+00,3.827939748764038086e+00,3.928332567214965820e+00,4.065406799316406250e+00,4.035951614379882812e+00,4.306935787200927734e+00,4.728461742401123047e+00,4.979877471923828125e+00,5.403311729431152344e+00,5.620829105377197266e+00,6.096718788146972656e+00,6.679432392120361328e+00], 
[1.323253059387207031e+01,7.498813629150390625e+00,5.072794914245605469e+00,5.378992557525634766e+00,5.072486400604248047e+00,4.848636627197265625e+00,4.969520092010498047e+00,5.231507778167724609e+00,5.812240600585937500e+00,6.149884223937988281e+00,6.183029651641845703e+00,6.212879657745361328e+00,6.416185379028320312e+00,6.870306491851806641e+00,7.243989467620849609e+00], 
[1.400024414062500000e+01,8.418539047241210938e+00,6.320809841156005859e+00,6.906092643737792969e+00,6.676134586334228516e+00,6.343484878540039062e+00,6.315196514129638672e+00,6.163321495056152344e+00,5.940398216247558594e+00,5.979193687438964844e+00,6.195950031280517578e+00,6.307025432586669922e+00,6.717981815338134766e+00,7.069344997406005859e+00,7.271579742431640625e+00], 
[1.297477626800537109e+01,1.016531753540039062e+01,1.012821388244628906e+01,9.911950111389160156e+00,9.481467247009277344e+00,9.510669708251953125e+00,9.545008659362792969e+00,9.689297676086425781e+00,9.680057525634765625e+00,9.727094650268554688e+00,9.488485336303710938e+00,9.258897781372070312e+00,9.348602294921875000e+00,9.499542236328125000e+00,9.664714813232421875e+00], 
[1.164784431457519531e+01,9.471519470214843750e+00,1.007442569732666016e+01,1.045050907135009766e+01,1.034204101562500000e+01,1.030494976043701172e+01,1.025623035430908203e+01,1.012722301483154297e+01,1.000576782226562500e+01,9.981826782226562500e+00,9.828355789184570312e+00,9.983073234558105469e+00,1.023362541198730469e+01,1.068800163269042969e+01,1.105949211120605469e+01], 
[1.199517250061035156e+01,9.968964576721191406e+00,1.059448242187500000e+01,1.072747707366943359e+01,1.049479293823242188e+01,1.031134033203125000e+01,1.028846549987792969e+01,1.035599327087402344e+01,1.039956378936767578e+01,1.062246227264404297e+01,1.072140407562255859e+01,1.100739002227783203e+01,1.145080757141113281e+01,1.173728370666503906e+01,1.213283348083496094e+01], 
[1.321103286743164062e+01,1.063201618194580078e+01,1.012167549133300781e+01,1.012051296234130859e+01,1.001557445526123047e+01,1.017056846618652344e+01,1.055046558380126953e+01,1.078366565704345703e+01,1.103097915649414062e+01,1.099273872375488281e+01,1.070965099334716797e+01,1.068835926055908203e+01,1.079820156097412109e+01,1.120556068420410156e+01,1.153062915802001953e+01], 
[1.358657836914062500e+01,9.930617332458496094e+00,9.117251396179199219e+00,9.682261466979980469e+00,1.015217113494873047e+01,1.031504058837890625e+01,1.016412830352783203e+01,9.962630271911621094e+00,9.865384101867675781e+00,9.872683525085449219e+00,1.019650459289550781e+01,1.076221466064453125e+01,1.135993671417236328e+01,1.212191009521484375e+01,1.258028507232666016e+01], 
[1.421249961853027344e+01,1.046069908142089844e+01,9.261169433593750000e+00,9.514719963073730469e+00,9.554620742797851562e+00,9.275186538696289062e+00,9.064629554748535156e+00,8.932092666625976562e+00,8.824336051940917969e+00,8.820177078247070312e+00,9.573929786682128906e+00,1.044680881500244141e+01,1.116444492340087891e+01,1.215938186645507812e+01,1.253981876373291016e+01], 
[1.543842220306396484e+01,1.223203468322753906e+01,1.183845043182373047e+01,1.262202930450439453e+01,1.288276195526123047e+01,1.183499240875244141e+01,1.170528507232666016e+01,1.188657093048095703e+01,1.171802520751953125e+01,1.158502864837646484e+01,1.218473529815673828e+01,1.277984619140625000e+01,1.299722194671630859e+01,1.404169559478759766e+01,1.431195640563964844e+01], 
[1.521282291412353516e+01,1.256308555603027344e+01,1.149733448028564453e+01,1.246544551849365234e+01,1.284503936767578125e+01,1.179693889617919922e+01,1.154341125488281250e+01,1.141927242279052734e+01,1.170459461212158203e+01,1.196469211578369141e+01,1.247751617431640625e+01,1.266864299774169922e+01,1.295636558532714844e+01,1.406043052673339844e+01,1.399393367767333984e+01], 
[1.550062465667724609e+01,1.272441101074218750e+01,1.139900684356689453e+01,1.210555744171142578e+01,1.253187370300292969e+01,1.182762527465820312e+01,1.200940895080566406e+01,1.198042297363281250e+01,1.155042552947998047e+01,1.191420173645019531e+01,1.244957256317138672e+01,1.251373672485351562e+01,1.274760627746582031e+01,1.346085357666015625e+01,1.378641128540039062e+01], 
[1.561884117126464844e+01,1.182988548278808594e+01,1.115329933166503906e+01,1.189146518707275391e+01,1.235638809204101562e+01,1.241264247894287109e+01,1.247250080108642578e+01,1.187566661834716797e+01,1.183330249786376953e+01,1.198393058776855469e+01,1.230259609222412109e+01,1.256069564819335938e+01,1.290169715881347656e+01,1.350668048858642578e+01,1.379173183441162109e+01], 
[1.551603889465332031e+01,1.195127868652343750e+01,1.120906448364257812e+01,1.212036991119384766e+01,1.240056800842285156e+01,1.275637340545654297e+01,1.256857109069824219e+01,1.231383895874023438e+01,1.234498023986816406e+01,1.188233566284179688e+01,1.202228260040283203e+01,1.283470821380615234e+01,1.317165946960449219e+01,1.379993534088134766e+01,1.395215034484863281e+01] ]);

tdnn1Weight = tf.tensor(tdnn1Weight);
tdnn1Weight = tf.reshape(tdnn1Weight, [8, 16, 3]);
// tf.print(tdnn1Weight);
tdnn1Weight = tf.transpose(tdnn1Weight, [2, 1, 0]);
tdnn1Bias = tf.tensor(tdnn1Bias);


if(DEBUG){
  console.log('===== TDNN1 LAYER =====');
  console.log("weight", tdnn1Weight.shape, "should be (8, 16, 3)")
  console.log("bias", tdnn1Bias.shape, "should be (8,");
}


/** =====================================================
 *            TDNN2 Processing Params
 * =====================================================
 */
tdnn2Weight = tf.tensor(tdnn2Weight);
tdnn2Weight = tf.reshape(tdnn2Weight, [3, 8, 3]);
// tf.print(tdnn2Weight);
tdnn2Weight = tf.transpose(tdnn2Weight, [2, 1, 0]);
tdnn2Bias = tf.tensor(tdnn2Bias);

if(DEBUG){
  console.log('===== TDNN2 LAYER =====');
  console.log("weight", tdnn2Weight.shape, "should be (3, 8, 3)")
  console.log("bias", tdnn2Bias.shape, "should be (3,");
}

/** =====================================================
 *            LINEAR Processing Params
 * =====================================================
 */
linearWeight = tf.tensor(linearWeight);
linearWeight = tf.transpose(linearWeight, [1, 0]);
linearBias = tf.tensor(linearBias);

if(DEBUG){
  console.log('===== LINEAR LAYER =====');
  console.log("weight", linearWeight.shape, "should be (3, 27)")
  console.log("bias", linearBias.shape, "should be (3,");
}
  
/** =====================================================
 *           MODEL DEFINITION
 * =====================================================
 */


const model = tf.sequential();
  
// Adding tdnn1
const context1 = [-1, 0, 1];
model.add(tf.layers.conv1d({inputShape: [15, 16],
                            filters: 8,
                            kernelSize: 3,
                            dilationRate: 1, // 0 - (-1)
                            padding: 'valid', // no padding
                            // dataFormat: 'channelsFirst'
                            // bias term ?
                            }));
// console.log(tdnn1Weight.shape, tdnn1Bias.shape);

model.layers[0].setWeights([tdnn1Weight, tdnn1Bias]);

// Adding Sigmoid 1
model.add(tf.layers.activation({activation: 'sigmoid'}));

// Adding tdnn2
const context2 = [-2, 0, 2];
model.add(tf.layers.conv1d({inputShape: [13, 8],
                            filters: 3,
                            kernelSize: 3,
                            dilationRate: 2, // 0 - (-2)
                            padding: 'valid', // no padding
                            // dataFormat: 'channelsFirst'
                            // bias term ?
                            }));
model.layers[2].setWeights([tdnn2Weight, tdnn2Bias]);

// Adding Sigmoid 2
model.add(tf.layers.activation({activation: 'sigmoid'}));

// Adding Flatten
model.add(tf.layers.flatten({dataFormat: 'channelsFirst'}));

// Adding Linear
model.add(tf.layers.dense({inputDim: 27,
                          units: 3,
                          useBias: true}));
model.layers[5].setWeights([linearWeight, linearBias]);
  

/** =====================================================
 *           COMPILING THE MODEL
 * =====================================================
 */
model.compile({loss: 'categoricalCrossentropy', optimizer: 'sgd'});