<!DOCTYPE html>
<html>
  <head>
    <script src="bower_components/platform/platform.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script type="module">
        self.mean = tf.tensor([[-9.921779295944855903e+01, -9.504090236890817778e+01, -8.973951395087387084e+01, -8.813558030370704444e+01, -8.830461164898035520e+01, -8.856550378896328368e+01, -8.888497280347849028e+01, -8.919695596459642672e+01, -8.920588392858408611e+01, -8.911086566631610140e+01, -8.906545378265602153e+01, -8.904514218622436772e+01, -8.914320796529163715e+01, -8.955490017075669584e+01, -8.991511852336380173e+01],
                        [-9.075273659405756632e+01, -8.522021021517683437e+01, -7.967333662146580764e+01, -7.790902755360818333e+01, -7.802522402404873958e+01, -7.837438814249024688e+01, -7.870837898420491285e+01, -7.894293338570781771e+01, -7.885325426563987605e+01, -7.910064233854650695e+01, -7.926168331594702465e+01, -7.943693163225370313e+01, -7.991612965621173714e+01, -8.026557460613278749e+01, -8.086238828418217395e+01],
                        [-8.412980505689999688e+01, -6.861726509503944271e+01, -6.160314973518360659e+01, -6.338417906408213298e+01, -6.599926225194391805e+01, -6.798213181959354756e+01, -6.950867571228647535e+01, -7.063717526240688471e+01, -7.091154763452892951e+01, -7.082058905724690590e+01, -7.097939856408815729e+01, -7.131390446744566702e+01, -7.197601356561713715e+01, -7.263725258615436076e+01, -7.344943545691680242e+01],
                        [-8.202547463138840556e+01, -6.726231416943110730e+01, -5.978254379139583108e+01, -6.155418878231408542e+01, -6.529390954625277743e+01, -6.734430237812989617e+01, -6.786520803753280973e+01, -6.780727952312142293e+01, -6.755405051753206180e+01, -6.708668832543627047e+01, -6.696780552746422188e+01, -6.702466487469278889e+01, -6.764758838935929930e+01, -6.841865509653298716e+01, -6.933185566873093819e+01],
                        [-8.036808947381848611e+01, -6.402168821492631423e+01, -5.607803683564694097e+01, -5.880026675308737083e+01, -6.428195743533107986e+01, -6.832104446233962847e+01, -7.112860491659887430e+01, -7.360626133778963265e+01, -7.552907670218989722e+01, -7.663933951899690555e+01, -7.728362021148637950e+01, -7.783980912982292466e+01, -7.859137361523721665e+01, -7.903635458537905834e+01, -7.949150355633872778e+01],
                        [-8.586243808009973577e+01, -7.212140651088321874e+01, -6.461985399553495313e+01, -6.482037816926599305e+01, -6.638747799102384306e+01, -6.699520312615160833e+01, -6.709673100597453299e+01, -6.718971215346381598e+01, -6.749734921171634028e+01, -6.796173379729205521e+01, -6.862869039571509688e+01, -6.960827156698063334e+01, -7.095992656093204687e+01, -7.243919977705779445e+01, -7.385276274549597986e+01],
                        [-9.252242135655551181e+01, -8.193151522720846458e+01, -7.508731863079984237e+01, -7.333493310515869723e+01, -7.292675932398381633e+01, -7.279851943903287292e+01, -7.268202527825475556e+01, -7.286110524480677952e+01, -7.331530379141709375e+01, -7.410264474456299411e+01, -7.514087227986063056e+01, -7.653645959198041737e+01, -7.808035902291838681e+01, -7.972187457479135730e+01, -8.124538866771149515e+01],
                        [-9.631140203157599444e+01, -8.653365892318925034e+01, -8.058126815552289202e+01, -7.914875455172557395e+01, -7.901523831482376181e+01, -7.861658513770913714e+01, -7.815832889374178194e+01, -7.778380431353785696e+01, -7.776296050316709341e+01, -7.808189126888103715e+01, -7.881516162888924271e+01, -7.998609873933612846e+01, -8.121702075177594793e+01, -8.286320603014941355e+01, -8.452704968611629965e+01],
                        [-9.898570150699255521e+01, -8.902490052775478091e+01, -8.325490185276690625e+01, -8.206026553415594549e+01, -8.217173439878510521e+01, -8.206777378851859339e+01, -8.179553940749480034e+01, -8.158620012723483228e+01, -8.159113950687846284e+01, -8.194551992762417569e+01, -8.271591833194904098e+01, -8.379262108657459862e+01, -8.527125165078393820e+01, -8.693087593045393646e+01, -8.870130569391568542e+01],
                        [-9.731649517286325590e+01, -8.746131300130326736e+01, -8.236929510639782848e+01, -8.149582732467762014e+01, -8.243119718443672639e+01, -8.343588395250206702e+01, -8.419934852721901564e+01, -8.490606780806542986e+01, -8.560293743537714306e+01, -8.626958993765023820e+01, -8.705041088663442395e+01, -8.810765681938093508e+01, -8.930487206158686320e+01, -9.074024863166975763e+01, -9.222308047312610313e+01],
                        [-9.826397040689631979e+01, -8.894941416326558681e+01, -8.401177968549797015e+01, -8.338197573591213541e+01, -8.433952176518987187e+01, -8.555004024644028959e+01, -8.656682861283832153e+01, -8.752681908240684550e+01, -8.855826101316941390e+01, -8.962059532575233334e+01, -9.101209611159104895e+01, -9.245796829245779236e+01, -9.387190102077533993e+01, -9.542288815923284062e+01, -9.662643739896866180e+01],
                        [-9.758806770114317430e+01, -8.834228202808751007e+01, -8.355351584535551979e+01, -8.284117575480733819e+01, -8.438225965679816909e+01, -8.553290120472236424e+01, -8.683410727579811805e+01, -8.788557754649478682e+01, -8.858780119830881006e+01, -8.931116247523159757e+01, -9.036820358807878506e+01, -9.214134288837671249e+01, -9.370903188985040799e+01, -9.552278440057452258e+01, -9.680801415962473300e+01],
                        [-9.765616042935796770e+01, -8.873693786753970869e+01, -8.364011382502982883e+01, -8.329731536222992361e+01, -8.454096060809618507e+01, -8.573168055585576042e+01, -8.697410164931342536e+01, -8.778545989215113821e+01, -8.855834913322991042e+01, -8.963302993220756321e+01, -9.094887374412857639e+01, -9.237594458880376180e+01, -9.429281322772686735e+01, -9.624319595868425381e+01, -9.695342280660554479e+01],
                        [-9.815158038423092535e+01, -8.933801628854693888e+01, -8.410716047688389096e+01, -8.340456175561912744e+01, -8.445557337679261423e+01, -8.543481285305604445e+01, -8.658629289801477569e+01, -8.749824951349044966e+01, -8.807287346849594201e+01, -8.953565821765296562e+01, -9.124960318289923578e+01, -9.246335969988597014e+01, -9.420965479835543022e+01, -9.559263646827554339e+01, -9.662376084348460381e+01],
                        [-9.828051817053807326e+01, -8.904106305680184619e+01, -8.426504379294607361e+01, -8.347032146703003264e+01, -8.486687533152985452e+01, -8.609704697806880347e+01, -8.698791094200012708e+01, -8.745210689660945036e+01, -8.841204860559915346e+01, -8.972669369458114375e+01, -9.148092522918744862e+01, -9.288640740647890937e+01, -9.457704844149519374e+01, -9.601775870579247396e+01, -9.699619168640047917e+01],
                        [-9.812028448052261353e+01, -8.886189397360659825e+01, -8.393420566841203367e+01, -8.361577577964661145e+01, -8.467248749975196631e+01, -8.585780364370138784e+01, -8.655090891778556283e+01, -8.710252166659461182e+01, -8.824202473589228646e+01, -8.932932631959070591e+01, -9.117467536427977848e+01, -9.287102187423816702e+01, -9.428779325775899167e+01, -9.571418749472918819e+01, -9.688136771524592916e+01],
                        ]);
        self.std = tf.tensor([
        [7.286668624295761454e+00, 6.188322730874405764e+00, 5.261313414160342816e+00, 4.813804650930848084e+00, 4.846254177390325601e+00, 4.928120517923108679e+00, 5.110628872465769135e+00, 4.972703492092898081e+00, 5.104121176992391540e+00, 5.047996496430074309e+00, 5.049501916797716206e+00, 4.972665288182120058e+00, 5.137493630015012691e+00, 5.247234809997560312e+00, 5.731357695858214640e+00],
        [6.222726552219799423e+00, 6.355200195538980523e+00, 5.592861929227797901e+00, 4.965898420667410385e+00, 4.593947561127387225e+00, 4.618380428753004807e+00, 4.559983249040277187e+00, 4.647741335784619565e+00, 4.734766900657366051e+00, 4.709230721526005858e+00, 4.746862685045726060e+00, 4.817993885350151828e+00, 4.895244911128163956e+00, 5.104074127275255890e+00, 5.425696186536110410e+00],
        [1.149276954358194303e+01, 6.950008622509002087e+00, 3.789078716475736019e+00, 3.822899114287794831e+00, 3.825160927584695170e+00, 3.925480714904737489e+00, 4.062455440517886096e+00, 4.033021711769053219e+00, 4.303809246110916753e+00, 4.725029214791585552e+00, 4.976262344758877632e+00, 5.399389045252785735e+00, 5.616748615195561456e+00, 6.092293093496623513e+00, 6.674583280583751943e+00],
        [1.322292410839044585e+01, 7.493369872956865407e+00, 5.069112290793458264e+00, 5.375087603161272654e+00, 5.068803979686340000e+00, 4.845116805284191308e+00, 4.965912247567180415e+00, 5.227710146093220267e+00, 5.808021060382837497e+00, 6.145419799341554246e+00, 6.178541241400212769e+00, 6.208369330504670991e+00, 6.411527603499252770e+00, 6.865318843728352327e+00, 7.238730581419275723e+00],
        [1.399008021310209138e+01, 8.412427176272634810e+00, 6.316221081138832183e+00, 6.901079025981870174e+00, 6.671288150424958374e+00, 6.338879584539180101e+00, 6.310612002899705253e+00, 6.158847140121669561e+00, 5.936086000325309087e+00, 5.974853076961812448e+00, 6.191452165526021290e+00, 6.302446620380608877e+00, 6.713104888818222094e+00, 7.064212864325383201e+00, 7.266301046848555600e+00],
        [1.296535757482220497e+01, 1.015793838554453998e+01, 1.012086172905775427e+01, 9.904754207193757765e+00, 9.474583963547313914e+00, 9.503765775264145788e+00, 9.538079755101183110e+00, 9.682263797336805311e+00, 9.673029888569622869e+00, 9.720033605957080880e+00, 9.481597138503030209e+00, 9.252176689582645608e+00, 9.341815542032877673e+00, 9.492645775113203399e+00, 9.657698964216805848e+00],
        [1.163938877283649376e+01, 9.464643295204977491e+00, 1.006711246545269134e+01, 1.044292278560415355e+01, 1.033453286019951634e+01, 1.029746898153433854e+01, 1.024878478089102174e+01, 1.011987141385173672e+01, 9.998504271606449834e+00, 9.974580314522679458e+00, 9.821220613669742860e+00, 9.975826079756643594e+00, 1.022619662886315339e+01, 1.068024265113605686e+01, 1.105146386100367728e+01],
        [1.198646429637759958e+01, 9.961727265084961758e+00, 1.058679147449905678e+01, 1.071968932131252217e+01, 1.048717428816468455e+01, 1.030385517460335976e+01, 1.028099643148885356e+01, 1.034847494820489189e+01, 1.039201385587929671e+01, 1.061475104074391851e+01, 1.071362084354512589e+01, 1.099939899780413022e+01, 1.144249443389244014e+01, 1.172876333131877757e+01, 1.212402573229997849e+01],
        [1.320144205301844309e+01, 1.062429762279809076e+01, 1.011432786428976627e+01, 1.011316636261457980e+01, 1.000830360630071425e+01, 1.016318481843081045e+01, 1.054280680053829045e+01, 1.077583728416845155e+01, 1.102297115676767447e+01, 1.098475840239842327e+01, 1.070187625607728776e+01, 1.068059993922534900e+01, 1.079036248398540820e+01, 1.119742616111521194e+01, 1.152225840218803476e+01],
        [1.357671492964433391e+01, 9.923407894323696965e+00, 9.110633108982900907e+00, 9.675232948553105672e+00, 1.014480103754114637e+01, 1.030755228571678650e+01, 1.015674997291133153e+01, 9.955398041479911697e+00, 9.858222650289091504e+00, 9.865516606920182952e+00, 1.018910249849788663e+01, 1.075440217074224414e+01, 1.135169024805441929e+01, 1.211311021263566801e+01, 1.257115260221323538e+01],
        [1.420218166208538513e+01, 1.045310557144564889e+01, 9.254446194736109632e+00, 9.507813199441947916e+00, 9.547684205552284809e+00, 9.268452961009465696e+00, 9.058048852136838747e+00, 8.925607953894054702e+00, 8.817929853875188684e+00, 8.813773960142384567e+00, 9.566979700998496483e+00, 1.043922529607286442e+01, 1.115633967972823903e+01, 1.215055452075874420e+01, 1.253071518904788562e+01],
        [1.542721471051009097e+01, 1.222315519311286636e+01, 1.182985658445341670e+01, 1.261286586019639877e+01, 1.287341006487998740e+01, 1.182640100595713051e+01, 1.169678711126175052e+01, 1.187794200826878743e+01, 1.170951803983771633e+01, 1.157661892753010235e+01, 1.217588985729190298e+01, 1.277056879468613282e+01, 1.298778619037931925e+01, 1.403150206344887785e+01, 1.430156703513895877e+01],
        [1.520177876315661081e+01, 1.255396516768548842e+01, 1.148898759698637662e+01, 1.245639595738716388e+01, 1.283571415368146695e+01, 1.178837519712128135e+01, 1.153503128140190626e+01, 1.141098226556180961e+01, 1.169609743228173748e+01, 1.195600635491226882e+01, 1.246845854051796998e+01, 1.265944586240405023e+01, 1.294696019483553684e+01, 1.405022313104263532e+01, 1.398377439219162000e+01],
        [1.548937150996751377e+01, 1.271517357591173969e+01, 1.139073171822060360e+01, 1.209676925353820565e+01, 1.252277569997614037e+01, 1.181903891669183615e+01, 1.200069087394632916e+01, 1.197172569472403403e+01, 1.154204084715996004e+01, 1.190555285081449632e+01, 1.244053481983413434e+01, 1.250465220922589715e+01, 1.273835247313514429e+01, 1.345108167825863887e+01, 1.377640273085810740e+01],
        [1.560750248845418930e+01, 1.182129760985778866e+01, 1.114520254304939151e+01, 1.188283245879660299e+01, 1.234741832871065448e+01, 1.240363140302228118e+01, 1.246344646967970249e+01, 1.186704556855528558e+01, 1.182471179039792730e+01, 1.197523078119053608e+01, 1.229366514916924125e+01, 1.255157673146142372e+01, 1.289233096505268783e+01, 1.349687490194341954e+01, 1.378171974757912110e+01],
        [1.550477521004400749e+01, 1.194260282173696375e+01, 1.120092687631478690e+01, 1.211157118062989468e+01, 1.239156596716742698e+01, 1.274711324083283159e+01, 1.255944679643404349e+01, 1.230489997620647635e+01, 1.233601799052070724e+01, 1.187370991828170297e+01, 1.201355521816218008e+01, 1.282539098259325883e+01, 1.316209747244972483e+01, 1.378991698968482638e+01, 1.394202175638105423e+01],
        ]);

        console.log('loaded mean and std');
        // tf.print(mean)
        // tf.print(std)

        self.model = await tf.loadLayersModel('tfjs_model/model.json');

        console.log('loaded model')

        // var data = tf.zeros([1, 15, 16]);
        // data[0, 10, 4] = 1;
        var data = tf.tensor([[[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]]]);
        self.data = data;
        // dataTensor = tf.tensor([[[-79.98849487304688, -79.98849487304688, -77.7100830078125, -77.7100830078125, -77.8009033203125, -75.5801010131836, -76.37616729736328, -79.50062561035156, -78.42376708984375, -78.42376708984375, -74.0884017944336, -72.00096130371094, -71.10459899902344, -71.10459899902344, -76.475830078125], [-71.23374938964844, -71.23374938964844, -70.56405639648438, -70.56405639648438, -69.72421264648438, -68.59850311279297, -68.64933776855469, -66.18293762207031, -65.80322265625, -65.80322265625, -65.563232421875, -65.03482818603516, -63.44944381713867, -63.44944381713867, -60.16942596435547], [-55.574337005615234, -55.574337005615234, -47.95212173461914, -47.95212173461914, -46.799198150634766, -46.033477783203125, -48.495357513427734, -52.989219665527344, -55.6395263671875, -55.6395263671875, -53.095252990722656, -52.47209167480469, -52.12949752807617, -52.12949752807617, -52.2476806640625], [-60.93266677856445, -60.93266677856445, -50.79570388793945, -50.79570388793945, -48.455230712890625, -46.94056701660156, -49.35388946533203, -54.39780807495117, -57.02521514892578, -57.02521514892578, -58.10628128051758, -59.87185287475586, -62.142486572265625, -62.142486572265625, -63.78534698486328], [-57.54692077636719, -57.54692077636719, -52.34580993652344, -52.34580993652344, -53.246925354003906, -54.19032287597656, -57.91514587402344, -63.239463806152344, -65.68925476074219, -65.68925476074219, -64.91397094726562, -65.65262603759766, -66.7035140991211, -66.7035140991211, -70.1640853881836], [-49.78595733642578, -49.78595733642578, -40.7869758605957, -40.7869758605957, -39.404842376708984, -39.316802978515625, -42.903480529785156, -47.21501922607422, -52.77900695800781, -52.77900695800781, -54.723968505859375, -55.50493621826172, -56.974327087402344, -56.974327087402344, -57.595603942871094], [-61.879722595214844, -61.879722595214844, -50.95133972167969, -50.95133972167969, -49.37113952636719, -47.42070007324219, -48.360145568847656, -52.293766021728516, -56.48970031738281, -56.48970031738281, -59.68684768676758, -59.69374084472656, -60.69267654418945, -60.69267654418945, -60.457332611083984], [-71.81537628173828, -71.81537628173828, -60.147911071777344, -60.147911071777344, -57.81268310546875, -56.5998649597168, -55.694522857666016, -57.13825988769531, -61.02383804321289, -61.02383804321289, -64.17247772216797, -65.56964111328125, -67.28486633300781, -67.28486633300781, -65.40653228759766], [-80.25143432617188, -80.25143432617188, -67.66596984863281, -67.66596984863281, -65.13922882080078, -61.50669860839844, -60.802581787109375, -62.9771614074707, -67.80245971679688, -67.80245971679688, -71.14988708496094, -71.98603820800781, -73.21566009521484, -73.21566009521484, -71.70726013183594], [-90.14971923828125, -90.14971923828125, -80.05545806884766, -80.05545806884766, -77.82617950439453, -75.71304321289062, -76.2440185546875, -77.32179260253906, -77.65482330322266, -77.65482330322266, -78.3183822631836, -77.73072052001953, -77.2223892211914, -77.2223892211914, -79.06549072265625], [-95.42420959472656, -95.42420959472656, -87.02458190917969, -87.02458190917969, -84.40901184082031, -80.60292053222656, -80.14845275878906, -81.15443420410156, -81.40777587890625, -81.40777587890625, -82.99018096923828, -84.13994598388672, -86.31503295898438, -86.31503295898438, -87.80577087402344], [-85.7823486328125, -85.7823486328125, -82.91358947753906, -82.91358947753906, -82.72102355957031, -83.0540771484375, -84.18526458740234, -86.17202758789062, -88.67229461669922, -88.67229461669922, -89.42324829101562, -89.13890838623047, -89.08311462402344, -89.08311462402344, -90.54974365234375], [-84.62126922607422, -84.62126922607422, -82.11570739746094, -82.11570739746094, -82.61753845214844, -84.04685974121094, -85.7686767578125, -89.35237884521484, -100.06378936767578, -100.06378936767578, -98.30436706542969, -95.02717590332031, -95.89132690429688, -95.89132690429688, -100.33302307128906], [-82.78972625732422, -82.78972625732422, -87.57361602783203, -87.57361602783203, -93.32467651367188, -92.9811019897461, -93.73509216308594, -96.12415313720703, -93.95369720458984, -93.95369720458984, -93.86746215820312, -94.38320922851562, -97.99455261230469, -97.99455261230469, -98.1867904663086], [-80.4544906616211, -80.4544906616211, -84.25881958007812, -84.25881958007812, -87.28688049316406, -93.23606872558594, -104.88142395019531, -108.22702026367188, -94.93336486816406, -94.93336486816406, -91.039306640625, -91.21568298339844, -94.58306121826172, -94.58306121826172, -93.51554107666016], [-79.54638671875, -79.54638671875, -78.08970642089844, -78.08970642089844, -79.2179946899414, -83.53546142578125, -88.83283996582031, -90.3853988647461, -90.50848388671875, -90.50848388671875, -91.21754455566406, -91.45297241210938, -93.34090423583984, -93.34090423583984, -92.16254425048828]]]);
        
        var y = self.model.predict(data);

        var inputs = data;
        for(var i = 1; i < 5; i ++){
            inputs = self.model.layers[i].apply(inputs=inputs);
            console.log('input at layer', i);
            tf.print(inputs)
        }

        console.log('running the model using model.predict gives the tensor');
        tf.print(y)
    </script>
  </head>
  <body>
  </body>
</html>
